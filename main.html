<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SVG Costume Editor</title> <!-- Added site title -->
<link rel="icon" type="image/svg+xml" href="./assets/favicon.svg">
<link rel="icon" type="image/png" href="./assets/favicon.png"> <!-- Added site icon -->
<style>
    body, html {
        height: 100%;
        margin: 0;
        overflow: hidden;
        font-family: Arial, sans-serif; /* Changed font to Arial with fallback to sans-serif */
    }

    #container {
        display: flex;
        flex-direction: column;
        height: 100%;
    }

    #svg-container {
        flex-grow: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: auto; /* Changed overflow property to auto */
    }

    #color-picker-container {
        display: flex;
        justify-content: center;
        align-items: center;
    }

    #color-picker,
    #color-hex,
    #file-input {
        margin: 10px;
    }

    #color-bank {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        margin-top: 20px;
    }

    .color-option {
        width: 30px;
        height: 30px;
        margin: 0 5px;
        border-radius: 50%;
        cursor: pointer;
    }

    /* Button styling */
    button {
        padding: 10px 20px;
        background-color: #007bff; /* Changed button background color to blue */
        color: #fff; /* Changed button text color to white */
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-family: Arial, sans-serif; /* Changed font to Arial with fallback to sans-serif */
        transition: background-color 0.3s ease; /* Added transition effect */
    }

    button:hover {
        background-color: #0056b3; /* Darker blue color on hover */
    }

    #add-color {
        margin-left: 0;
    }

    #file-input {
        background-color: #007bff;
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        padding: 10px 20px;
        font-family: Arial, sans-serif;
        transition: background-color 0.3s ease;
    }

    #file-input:hover {
        background-color: #0056b3;
    }
</style>
</head>
<body>
    <div id="container">
        <input type="file" id="file-input">
        <div id="svg-container"></div>
        <div id="color-picker-container">
            <input type="color" id="color-picker">
            <input type="text" id="color-hex" placeholder="Hex code">
            <button id="add-color">Add Color</button>
        </div>
        <div id="color-bank">
            <h2>Color Bank</h2> <!-- Added title for color bank -->
        </div>
    </div>

    <script>
        document.getElementById('file-input').addEventListener('change', handleFileSelect);

        function handleFileSelect(event) {
            const file = event.target.files[0];
            const reader = new FileReader();

            reader.onload = function (e) {
                const svgString = e.target.result;
                renderSVG(svgString);
            };

            reader.readAsText(file);
        }

        function renderSVG(svgString) {
            const svgContainer = document.getElementById('svg-container');
            svgContainer.innerHTML = svgString;

            const svg = svgContainer.querySelector('svg');

            // Set initial SVG dimensions
            svg.style.width = '100%';
            svg.style.height = '100%';

            const colorPicker = document.getElementById('color-picker');
            const colorHex = document.getElementById('color-hex');
            const colorBank = document.getElementById('color-bank');
            const svgElements = svgContainer.querySelectorAll('path'); // Adjust if other SVG elements are used

            for (let i = 0; i < svgElements.length; i++) {
                svgElements[i].addEventListener('click', function () {
                    this.style.fill = colorPicker.value;
                });
            }

            colorPicker.addEventListener('change', function () {
                colorHex.value = this.value;
            });

            colorHex.addEventListener('change', function () {
                colorPicker.value = this.value;
            });

            document.getElementById('add-color').addEventListener('click', function () {
                const color = colorHex.value;
                if (color) {
                    // Remove previous event listener to prevent adding multiple listeners
                    const colorOption = document.createElement('div');
                    colorOption.classList.add('color-option');
                    colorOption.style.backgroundColor = color;
                    colorOption.addEventListener('click', function () {
                        colorPicker.value = color; // Set the selected color of the color picker
                    });
                    colorBank.appendChild(colorOption);
                }
            });

            // Zooming functionality
            let zoomLevel = 1;
            svgContainer.addEventListener('wheel', function (event) {
                event.preventDefault();
                const zoomSpeed = 0.05;
                zoomLevel += event.deltaY * -zoomSpeed;
                zoomLevel = Math.max(0.1, zoomLevel);

                // Update SVG dimensions
                svg.style.width = `${100 * zoomLevel}%`;
                svg.style.height = `${100 * zoomLevel}%`;

                // Update scroll position based on zoom level
                const scrollLeft = svgContainer.scrollLeft;
                const scrollTop = svgContainer.scrollTop;
                const centerX = scrollLeft + svgContainer.offsetWidth / 2;
                const centerY = scrollTop + svgContainer.offsetHeight / 2;
                const newScrollLeft = (centerX * zoomLevel - svgContainer.offsetWidth / 2) / zoomLevel;
                const newScrollTop = (centerY * zoomLevel - svgContainer.offsetHeight / 2) / zoomLevel;
                svgContainer.scrollLeft = newScrollLeft;
                svgContainer.scrollTop = newScrollTop;
            });

            // Panning functionality
            let isPanning = false;
            let startCoords = { x: 0, y: 0 };
            svgContainer.addEventListener('mousedown', function (event) {
                isPanning = true;
                startCoords = { x: event.clientX, y: event.clientY };
                svgContainer.style.cursor = 'grabbing';
            });

            svgContainer.addEventListener('mousemove', function (event) {
                if (isPanning) {
                    const deltaX = event.clientX - startCoords.x;
                    const deltaY = event.clientY - startCoords.y;
                    svgContainer.scrollLeft -= deltaX;
                    svgContainer.scrollTop -= deltaY;
                    startCoords = { x: event.clientX, y: event.clientY };
                }
            });

            document.addEventListener('mouseup', function () { // Changed to listen on document
                isPanning = false;
                svgContainer.style.cursor = 'grab';
            });
        }
    </script>
</body>
</html>
